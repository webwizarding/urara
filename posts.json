[{"created":"2024-04-05T21:48:42.619Z","updated":"2024-04-05T21:48:42.619Z","images":[],"tags":[],"slug":"/torvulns/+page.svelte.md","path":"/torvulns","toc":[{"depth":1,"title":"POST","slug":"post"},{"depth":2,"title":"Tor/TorBrowser","slug":"tortorbrowser"},{"depth":2,"title":"Onionbalance V3","slug":"onionbalance-v3"},{"depth":2,"title":"Stem (Python Tor Library)","slug":"stem-python-tor-library"}],"type":"note","html":"<h1 id=\"post\" data-svelte-h=\"svelte-o3h0hg\"><a href=\"#post\">POST</a></h1> <p data-svelte-h=\"svelte-122xy6d\">This post will go through the vulnerabilites of tor/torbrowser, onion balance and the stem library.The vulnerabilties may not directly affect the onion relay protocol but nontheless Tor is not entirely secure.</p> <hr> <h2 id=\"tortorbrowser\" data-svelte-h=\"svelte-pv46f1\"><a href=\"#tortorbrowser\">Tor/TorBrowser</a></h2> <p data-svelte-h=\"svelte-1n2ga7t\">The Tor/Torbrowser in total have 41 combined found vulnerabiltiesWe will only be going over the important vulns I think is interesting</p> <!-- HTML_TAG_START --><pre class=\"shiki material-default\"><div class='code-container'><code><div class='line'>‎scripts/test/appveyor-irc-notify.py</div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h=\"svelte-1qxdgup\">CWE-327 (<a href=\"https://cwe.mitre.org/data/definitions/327.html\" rel=\"nofollow noopener noreferrer external\" target=\"_blank\">https://cwe.mitre.org/data/definitions/327.html</a>)Calling to a deprecated function like ssl.wrap_socket doesnt entirely specify the protocol and can result in an insecure default being usedSome ways we can try preventing this is avoiding calling ssl.wrap_socket without specifying the ssl_version</p> <p data-svelte-h=\"svelte-o419uc\">Using ssl.wrap_socket without specifying the ssl_version can lead to an outdated and weak security protocol It’s crucial to encrypt sensitive data for protection Encryption standards need to stay current because attackers keep getting better at breaking them So your encryption should always be up to date and strong enough for the type of data you have</p> <!-- HTML_TAG_START --><pre class=\"shiki material-default\"><div class='code-container'><code><div class='line'>‎scripts/maint/add_c_file.py</div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h=\"svelte-1y735x9\">CWE-23 (<a href=\"https://cwe.mitre.org/data/definitions/23.html\" rel=\"nofollow noopener noreferrer external\" target=\"_blank\">https://cwe.mitre.org/data/definitions/23.html</a>)Unsanitized input from a command line argument flows into open where it used as a path so it can become a path traversal vulnerability that can allow someone to write arbitrary filesWith a vulnerability like this we can do something known as a directory traversal attack which main purpose is to access files and directories that are stored outside the intended folderIn this example it is a Zip-Slip type vulnerability that allows us to create and replace existing files which we can use something like this</p> <!-- HTML_TAG_START --><pre class=\"shiki material-default\"><div class='code-container'><code><div class='line'>curl http://localhost:8080/public/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/root/.ssh/id_rsa</div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h=\"svelte-spqj5s\">That will allow use to leak the private key of root and then using a malicious zip archive that holds path traversal filenames then when the zip archive is extracted it will result in traversing out the target folder and ending up in a /root/.ssh/ directory for example</p> <!-- HTML_TAG_START --><pre class=\"shiki material-default\"><div class='code-container'><code><div class='line'>torbrowser_launcher/common.py</div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h=\"svelte-4uxdzl\">CWE-502 (<a href=\"https://cwe.mitre.org/data/definitions/502.html\" rel=\"nofollow noopener noreferrer external\" target=\"_blank\">https://cwe.mitre.org/data/definitions/502.html</a>)</p> <p data-svelte-h=\"svelte-jfmawv\">Unsantized input from a command line argument flows into pickle.load where it can result in unsafe deserialization vulnsThe vulnerability that can be found here is a process of converting an object into a sequence of bytes that can persist to a disk or database that can be sent through streams</p> <hr> <h2 id=\"onionbalance-v3\" data-svelte-h=\"svelte-1bnvcow\"><a href=\"#onionbalance-v3\">Onionbalance V3</a></h2> <p data-svelte-h=\"svelte-1icy0ok\">This has a total of 20 reps and its primary function is to allow tor onion service requests to be distributed across multiple backend tor instancesand it provides load balancing while also making onion services more resilient and reliable by elimating single points of failure</p> <!-- HTML_TAG_START --><pre class=\"shiki material-default\"><div class='code-container'><code><div class='line'>versioneer.py:393</div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h=\"svelte-pk751r\">CWE-78 (<a href=\"https://cwe.mitre.org/data/definitions/78.html\" rel=\"nofollow noopener noreferrer external\" target=\"_blank\">https://cwe.mitre.org/data/definitions/78.html</a>)Unsanitized input from command line argument flows into subprocess.popen that can result in a command injection vulnerabilityThe vulnerability can be done by using an OS command injection attack that allows users to pass commands directly to the system shell attached to a legit request</p> <hr> <h2 id=\"stem-python-tor-library\" data-svelte-h=\"svelte-1dvvl1s\"><a href=\"#stem-python-tor-library\">Stem (Python Tor Library)</a></h2> <p data-svelte-h=\"svelte-1g2u0we\">This rep has 27 vulnerabilitiesStem is a Python controller library for Tor With it you can use Tor’s control protocol to script against the Tor process or build things such as Nyx</p> <!-- HTML_TAG_START --><pre class=\"shiki material-default\"><div class='code-container'><code><div class='line'>docs/_static/example/words_with.py</div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h=\"svelte-llxhxi\">CWE-400 (<a href=\"https://cwe.mitre.org/data/definitions/400.html\" rel=\"nofollow noopener noreferrer external\" target=\"_blank\">https://cwe.mitre.org/data/definitions/400.html</a>)User input from user input flows into re.compile can have a result of a ReDOS vulnThis vulnerability is mainly surrounded around the regex engine that uses regular expressions to make a system inaccessible to usersIt can be done by using a regex regular expression string that includes 14 C’s that the engine needs to take over 65k steps just to see if the string is a valid stringit will cause the CPU to be overloaded and work very slowly becoming a DOS</p> <hr>"},{"title":"Roblox Osint","image":"/roblox osint/0.png","alt":"Urara","created":"2023-11-23T00:00:00.000Z","updated":"2021-11-23T00:00:00.000Z","tags":["Hello World"],"images":[],"slug":"/roblox osint/+page.svelte.md","path":"/roblox osint","toc":[{"depth":1,"title":"POST","slug":"post"},{"depth":2,"title":"ROBLOX?","slug":"roblox"},{"depth":3,"title":"General Location Finding","slug":"general-location-finding"},{"depth":3,"title":"User Data","slug":"user-data"},{"depth":3,"title":"SOURCES","slug":"sources"}],"type":"article","html":""},{"title":"Argonhosting investigation","image":"/roblox osint/polyc2.png","alt":"Urara","created":"2023-08-11T00:00:00.000Z","updated":"2021-08-11T00:00:00.000Z","tags":["Hello World"],"images":[],"slug":"/Argonhosting/+page.svelte.md","path":"/Argonhosting","toc":[{"depth":1,"title":"POST","slug":"post"},{"depth":3,"title":"Summary:","slug":"summary"},{"depth":3,"title":"Drama:","slug":"drama"},{"depth":3,"title":"MISTAKE 1 Ip history","slug":"mistake-1-ip-history"},{"depth":3,"title":"MISTAKE 2 UFW","slug":"mistake-2-ufw"},{"depth":3,"title":"MISTAKE 3 MariaDB","slug":"mistake-3-mariadb"},{"depth":3,"title":"MISTAKE 4 Common Vulns","slug":"mistake-4-common-vulns"}],"type":"article","html":""},{"title":"The ZeroMQ Protocol","image":"/zeromqprot/0mq0.png","alt":"Urara","created":"2023-08-06T00:00:00.000Z","updated":"2021-08-06T00:00:00.000Z","tags":["Hello World"],"images":[],"slug":"/zeromqprot/+page.svelte.md","path":"/zeromqprot","toc":[{"depth":1,"title":"WHY USE ZEROMQ??","slug":"why-use-zeromq"},{"depth":3,"title":"Speed and performance:","slug":"speed-and-performance"},{"depth":3,"title":"Lightweight and Efficient:","slug":"lightweight-and-efficient"},{"depth":3,"title":"Security:","slug":"security"},{"depth":3,"title":"Load balancing :","slug":"load-balancing-"}],"type":"article","html":""}]